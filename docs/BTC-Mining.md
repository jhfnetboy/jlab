### 挖矿本质
+ 挖矿是个将待确认的交易数据包含到块链中，从而完成对这些交易进行确认的分布式共识系统。
+ 通过挖矿，可以强制性保证块链中的数据按时间顺序存储，保持比特币网络的中立性
+ 且允许比特币网络上不同的计算机对系统状态达成一致。交易要获得确认
+ 必须要被打包到一个符合非常严格的加密规则的块中，并通过比特币网络进行验证。
+ 这些规则可以防止对已有块的修改，因为一旦有改动，之后所有的块都将失效。
+ 挖矿的难度和中彩票相当，没人可以轻易地、连续地将新块加入到块链中。
+ 因此，没人可以控制块链中包含什么样的内容或者替换掉块链中的部分内容以达到回滚他们的花费的目的。
+ 可以知道挖矿实际上是 交易数据保存 的过程，是在维护比特币网络。而比特币就是给维护网络者的奖励！
+ 比特币的挖矿和节点软件是基于P2P网络、数字签名、密码学证据来发起和验证交易的
需要以下参数
block的版本 version
上一个block的hash值: prev_hash
需要写入的交易记录的hash树的值: merkle_root
更新时间: ntime
当前难度: nbits

挖矿的过程就是找到x使得
SHA256(SHA256(version + prev_hash + merkle_root + ntime + nbits + x )) < TARGET

上式的x的范围是0~2^32, TARGET可以根据当前难度求出的。除了x之外，你还可以尝试改动merkle_root和ntime。由于hash的特性，找这样一个x只能暴力搜索。

一旦你找到了x，你就可以广播一个新的block，其他客户端会验证你的block是否合法。如果你的block被接受，由于每个block中的第一笔交易必须是将新产生25个比特币发送到某个地址，当然你会把这个地址设为你所拥有的地址来得到这25个比特币。

---------------------------------------------------------------

比特币从开始到现在的每一笔交易记录都保存在网络上，整个比特币网络维护的一个巨大的交易记录文件（现在大约12G）。 这个文件的更新周期平均是10分钟，新加入的交易记录叫做一个block，而这个硕大的文件由一串block组成，叫做block chain. 



为什么是25个比特币？
这是规定。最初是50个比特币，每产生剩下比特币的一半，这个所得就会减半，这样最终能产生的比特币总量趋近于2100万。如果你现在仍然声称挖到了50个比特币，这是不会被其他客户端接受的，这个block就算白挖了。

怎么保证更新周期平均是10分钟？
TARGET越小，解出x的难度就越大，每产生2016个block(约14天)，网络会根据这段时间产生新block的平均间隔调整之后的TARGET。

是不是计算速度最快的人总是先解出来？
不是。你总是想把挖矿所得据为己有，所以每个人在计算时，发送挖矿所得的地址是不一样的，这样merkle_root就不同，也就是说每个人是从不同的初始状态开始求解的。

同时解出来怎么办？
block chain会出现分叉，部分客户端接受了A，部分接受了B，直到某个分支变得更长，所有人就会选择这个更长的分支。如果你挖出来的不幸没有被选中，你的挖矿所得就无效了。

既然选更长的分支，那我用很低的难度去求解怎么办？
客户端在众多分支中找到符合当前难度且最长的。

这些计算浪费了吗？
如果你要把一笔钱花两次，你需要这么做。挖到一个新的block，但是藏着不广播，并继续挖矿。找到商家A，支付比特币，让网络上的其他人挖到block并写入这笔交易记录。找到商家B，支付比特币，写入自己挖的block。如果你能抢先挖到两个block并广播出去，所有人会以你这个更长的分支为当前的block chain，商家A收到的比特币就不被承认了。这样攻击成功的概率取决于你计算hash的速度。整个网络的计算力足够高的话，这样的攻击或者成功率极低，或者成本极大。

更合理的PoS共识机制